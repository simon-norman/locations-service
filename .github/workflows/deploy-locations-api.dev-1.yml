name: Deploy Locations API to dev one

on: workflow_dispatch

permissions:
    id-token: write
    contents: read

jobs:
  deployment:
    runs-on: ubuntu-latest
    environment: dev-1
    steps:
      - uses: simon-norman/actions/deploy@v1
        name: Deploy
        with:
          environment: dev-1
          file: ./monorepo/Dockerfile
          tag: locations-api-dev-1:latest
          aws_region: eu-west-2
          build_target: release_locations_api
          aws_access_key_id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws_access_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          app_name: locations-api
        env:
          PULUMI_ACCESS_TOKEN: ${{ secrets.PULUMI_ACCESS_TOKEN }}